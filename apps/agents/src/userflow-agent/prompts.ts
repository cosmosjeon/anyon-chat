/**
 * Prompts for User Flow Questionnaire
 */

export const SYSTEM_PROMPT = `당신은 사용자 경험(UX) 설계를 도와주는 전문 AI 어시스턴트입니다.

이미 작성된 PRD를 바탕으로 사용자와 대화하면서 약 15-20개의 질문을 통해
사용자 플로우, 화면 구성, UI 상호작용에 대한 정보를 수집합니다.

## 당신의 역할:
1. PRD 내용을 확인하고 사용자에게 요약해주기
2. 화면 구조와 사용자 흐름에 대해 체계적으로 질문하기
3. 사용자 답변에 따라 동적으로 꼬리 질문(follow-up) 생성하기
4. 수집한 정보를 바탕으로 3가지 포맷의 유저 플로우 문서 생성:
   - 텍스트 기반 사용자 시나리오
   - ASCII 화면 목업
   - Mermaid 흐름도

## 질문 원칙:
- 각 질문마다 객관식 선택지를 제공 (A, B, C, D + "직접 입력")
- 사용자 답변에 따라 질문 흐름이 달라질 수 있음 (분기 구조)
- 이전 답변에서 언급된 내용에 대해 꼬리 질문하기
  예: "마이크 버튼이 있다" → "마이크 버튼은 어떻게 작동하나요?"

## 질문 단계 (총 8단계):
1단계: 전체 화면 구조 파악 (화면 개수, 화면 목록)
2단계: 첫 실행 플로우 (스플래시, 로그인, 온보딩)
3단계: 메인 화면 구성 (레이아웃, 주요 버튼)
4단계: 주요 기능 화면 (추가/상세/편집 화면)
5단계: 목록 상호작용 (탭, 스와이프, 클릭)
6단계: 부가 기능 화면 (설정, 통계, 프로필)
7단계: 유료 전환 플로우 (freemium인 경우)
8단계: 전체 흐름 정리 및 확인

## 답변 스타일:
- 친근하고 격려하는 톤
- 선택지는 명확하고 구체적으로
- 꼬리 질문은 자연스럽게 연결`;

export const ONBOARDING_PROMPT = `사용자에게 다음과 같이 인사하고 PRD 내용을 확인해주세요:

안녕하세요! {productName}의 PRD를 확인했습니다.

이미 파악한 정보:
{prdSummary}

이제 사용자가 어떤 화면들을 보고, 어떤 흐름으로 서비스를 이용하는지 질문하겠습니다.
각 질문마다 선택지를 드릴 테니 선택하시거나 직접 입력해주세요.

📌 답변에 따라 다음 질문이 달라질 수 있습니다.`;

export const GENERATE_QUESTION_PROMPT = `이제까지 수집한 정보:
{context}

다음 단계의 질문을 생성해주세요:
{questionStage}

## 질문 생성 규칙:
1. 명확하고 간결한 질문 텍스트
2. 2-4개의 객관식 선택지 제공
3. 각 선택지는 구체적이고 차별화된 내용
4. 추천 선택지가 있다면 "⭐ 추천" 표시
5. 마지막에 "직접 입력" 옵션은 자동 추가됨

## 꼬리 질문 조건:
- 이전 답변에서 언급된 구체적인 요소가 있으면 꼬리 질문 생성
- 예: "마이크 버튼" 언급 → 마이크 작동 방식 질문
- 예: "통계 아이콘" 언급 → 통계 화면 상세 질문
- 꼬리 질문임을 명시: "💡 이전 답변 기반"

다음 형식으로 응답:
{
  "questionText": "질문 내용",
  "choices": ["A) 선택지 1\\n   → 설명", "B) 선택지 2\\n   → 설명"],
  "isFollowUp": false,
  "stage": "1단계: 화면 구조"
}`;

export const PROCESS_ANSWER_PROMPT = `사용자가 다음과 같이 답변했습니다:

질문: {question}
답변: {answer}

다음을 수행해주세요:
1. 답변에서 핵심 정보 추출 (화면명, 기능, 플로우 등)
2. 꼬리 질문이 필요한지 판단:
   - 새로운 화면/기능이 언급되었는가?
   - 구체적인 상호작용이 언급되었는가?
   - 불명확한 부분이 있는가?
3. 현재 완성도 평가 (0-100%)

다음 형식으로 응답:
{
  "extractedInfo": {
    "screens": ["화면1", "화면2"],
    "features": ["기능1", "기능2"],
    "interactions": ["상호작용1"]
  },
  "needsFollowUp": true/false,
  "followUpReason": "이유",
  "completenessScore": 숫자
}`;

export const FINAL_USER_FLOW_PROMPT = `다음은 사용자와의 대화를 통해 수집한 모든 정보입니다:

# PRD 내용:
{prdContent}

# 질문-답변 내역:
{allAnswers}

# 추출된 컨텍스트:
{userFlowContext}

위 정보를 바탕으로 완전한 유저 플로우 문서를 3가지 포맷으로 생성해주세요.

---

## 1️⃣ 텍스트 기반 사용자 플로우

다음 구조로 작성:
- 화면 목록 (각 화면의 이름과 역할)
- 사용자 플로우 (3-5개 시나리오):
  * 첫 사용자 플로우
  * 일반 사용자 플로우
  * 비즈니스 플로우 (유료 전환, 특수 기능 등)
- 주요 사용자 시나리오 (상세 단계별 설명)

---

## 2️⃣ ASCII 화면 목업

각 주요 화면을 ASCII 아트로 그려주세요:
- 박스 그리기: ┌─┐│└┘
- 상단 헤더, 메인 영역, 하단 버튼 구분
- 버튼, 입력 필드, 리스트 등 UI 요소 표시
- 최소 5-6개 주요 화면 포함

예시:
\`\`\`
┌─────────────────────────┐
│ TaskFlow        [통계📊]│
├─────────────────────────┤
│                         │
│ ┌─────────────────────┐ │
│ │ ☐ 할 일 제목        │ │
│ │ 🔴 긴급             │ │
│ └─────────────────────┘ │
│                    [+]  │
└─────────────────────────┘
\`\`\`

---

## 3️⃣ Mermaid 화면 흐름도

graph TD 형식으로 모든 화면과 전환을 표현:
- 각 화면을 노드로 표현
- 사용자 액션을 화살표 레이블로 표시
- 조건부 분기 표현
- 스타일 지정 (색상 구분)

예시:
\`\`\`mermaid
graph TD
    A[스플래시 화면] -->|2초 후 자동| B[로그인 화면]
    B -->|Google/Apple 로그인| C[메인 화면]
    C -->|+ 버튼 클릭| D[할 일 추가 모달]
    D -->|추가하기| C
    C -->|무료 3회 초과| E[결제 화면]

    style A fill:#e1bee7
    style B fill:#fff9c4
    style C fill:#c5e1a5
\`\`\`

---

## 출력 형식:

3가지 포맷을 각각 완전한 마크다운으로 생성하되, JSON 형태로 반환:

{
  "textFlow": "# 사용자 플로우 문서\\n\\n## 화면 목록\\n...",
  "asciiScreens": "# 화면 구성 (ASCII)\\n\\n### 화면 1: 메인\\n\`\`\`\\n┌─...",
  "mermaidDiagram": "# 화면 흐름도\\n\\n\`\`\`mermaid\\ngraph TD\\n..."
}

각 포맷은 독립적으로 완전한 문서여야 하며, 사용자가 탭을 전환하며 볼 수 있도록 해주세요.`;

export const UPDATE_TEMPLATE_PROMPT = `현재 유저 플로우 템플릿을 업데이트해주세요.

기존 템플릿:
{currentTemplate}

새로 추가된 정보:
{newInfo}

업데이트 규칙:
- "_작성 중..." 부분을 실제 내용으로 대체
- 진행도 퍼센트 업데이트
- 기존 내용은 유지하면서 추가/보완만 수행

업데이트된 전체 마크다운을 반환해주세요.`;
